# Hi! I create an object file that "mentions" segments to the linker.
# If this is the first input in a link, then the linker will be forced
# to create segments in the order you specify.

# Usage: SegOrderForcingObj AsmDest SEG1 SEG2...

Set Exit 1 # fail if we fail

Set AsmDest "{1}.asm"
Set ObjDest "{1}"
Shift

Echo "; Auto-generated by SegOrderForcingObj" > "{AsmDest}"
Echo " case on" >> "{AsmDest}"

Loop
	If !{#}; Break; End
	Echo " seg '{1}'" >> "{AsmDest}"
	Echo "_fakemodule_{1} proc export" >> "{AsmDest}"
	Shift
End

Echo " end" >> "{AsmDest}"

Asm -o "{ObjDest}" "{AsmDest}"
